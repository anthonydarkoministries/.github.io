<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ministry Forms</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Popup styles */
    #popup {
      display: none;
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 2rem;
      border-radius: 0.5rem;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      z-index: 1000;
      text-align: center;
    }
    #popup button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: #4ade80;
      color: white;
      border: none;
      border-radius: 0.25rem;
      cursor: pointer;
    }
    #overlay {
      display: none;
      position: fixed;
      top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.5);
      z-index: 500;
    }
  </style>
</head>
<body class="bg-gray-100">

<!--
==========================
Google Apps Script doPost
==========================
Deploy this as a Web App and replace YOUR_WEB_APP_URL in the HTML forms with the URL.

function doPost(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var data = JSON.parse(e.postData.contents);

  // Get the target sheet
  var sheetName = data.sheet || "New Membership";
  var sheet = ss.getSheetByName(sheetName);

  if (!sheet) {
    return ContentService
      .createTextOutput(JSON.stringify({
        "result": "error",
        "message": "Sheet '" + sheetName + "' not found"
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }

  // Build row with timestamp
  var row = [new Date()];

  var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  for (var i = 1; i < headers.length; i++) {
    var key = headers[i];
    row.push(data[key] || "");
  }

  sheet.appendRow(row);

  return ContentService
    .createTextOutput(JSON.stringify({ "result": "success", "row": row }))
    .setMimeType(ContentService.MimeType.JSON);
}
-->

  <!-- Navigation -->
  <nav class="bg-white p-4 shadow flex justify-between">
    <div class="flex space-x-4">
      <a href="#home" class="nav-link">Home</a>
      <a href="#new-membership" class="nav-link">New Membership</a>
      <a href="#partnership" class="nav-link">Partnership Commitment</a>
      <a href="#prayer" class="nav-link">Prayer Request</a>
      <a href="#discipleship" class="nav-link">Discipleship</a>
      <a href="#mentorship" class="nav-link">Mentorship</a>
    </div>
    <button id="mobile-menu-button" class="md:hidden">Menu</button>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden p-4 bg-white shadow space-y-2">
    <a href="#home" class="nav-link">Home</a>
    <a href="#new-membership" class="nav-link">New Membership</a>
    <a href="#partnership" class="nav-link">Partnership Commitment</a>
    <a href="#prayer" class="nav-link">Prayer Request</a>
    <a href="#discipleship" class="nav-link">Discipleship</a>
    <a href="#mentorship" class="nav-link">Mentorship</a>
  </div>

  <!-- Pages -->
  <div class="page" id="home">
    <h1 class="text-2xl font-bold p-4">Welcome to Our Ministry Forms</h1>
  </div>

  <div class="page hidden" id="new-membership">
    <h2 class="text-xl p-4">New Membership Form</h2>
    <form action="https://script.google.com/macros/s/AKfycbyvlfVSIUt_K2ysIQ_r085KY83dky1QysnrEUOkc0gsYGtbYj-D0pj-G9MRqbRsqgvq/exec" method="POST" onsubmit="submitForm(event, this)" data-sheet="New Membership" class="p-4 space-y-2 bg-white rounded shadow">
      <input type="text" name="name" placeholder="Full Name" required class="w-full p-2 border rounded"/>
      <input type="email" name="email" placeholder="Email" required class="w-full p-2 border rounded"/>
      <button type="submit" class="p-2 bg-blue-500 text-white rounded">Submit</button>
    </form>
  </div>

  <div class="page hidden" id="partnership">
    <h2 class="text-xl p-4">Partnership Commitment Form</h2>
    <form action="https://script.google.com/macros/s/AKfycbyvlfVSIUt_K2ysIQ_r085KY83dky1QysnrEUOkc0gsYGtbYj-D0pj-G9MRqbRsqgvq/exec" method="POST" onsubmit="submitForm(event, this)" data-sheet="Partnership Commitment" class="p-4 space-y-2 bg-white rounded shadow">
      <input type="text" name="name" placeholder="Full Name" required class="w-full p-2 border rounded"/>
      <input type="number" name="amount" placeholder="Contribution Amount" required class="w-full p-2 border rounded"/>
      <button type="submit" class="p-2 bg-green-500 text-white rounded">Submit</button>
    </form>
  </div>

  <div class="page hidden" id="prayer">
    <h2 class="text-xl p-4">Prayer Request Form</h2>
    <form action="https://script.google.com/macros/s/AKfycbyvlfVSIUt_K2ysIQ_r085KY83dky1QysnrEUOkc0gsYGtbYj-D0pj-G9MRqbRsqgvq/exec" method="POST" onsubmit="submitForm(event, this)" data-sheet="Prayer request" class="p-4 space-y-2 bg-white rounded shadow">
      <input type="text" name="name" placeholder="Full Name" required class="w-full p-2 border rounded"/>
      <textarea name="request" placeholder="Your Prayer Request" required class="w-full p-2 border rounded"></textarea>
      <button type="submit" class="p-2 bg-yellow-500 text-white rounded">Submit</button>
    </form>
  </div>

  <div class="page hidden" id="discipleship">
    <h2 class="text-xl p-4">Discipleship Form</h2>
    <form action="https://script.google.com/macros/s/AKfycbyvlfVSIUt_K2ysIQ_r085KY83dky1QysnrEUOkc0gsYGtbYj-D0pj-G9MRqbRsqgvq/exec" method="POST" onsubmit="submitForm(event, this)" data-sheet="Discipleship" class="p-4 space-y-2 bg-white rounded shadow">
      <input type="text" name="name" placeholder="Full Name" required class="w-full p-2 border rounded"/>
      <input type="text" name="interest" placeholder="Area of Interest" class="w-full p-2 border rounded"/>
      <button type="submit" class="p-2 bg-purple-500 text-white rounded">Submit</button>
    </form>
  </div>

  <div class="page hidden" id="mentorship">
    <h2 class="text-xl p-4">Mentorship Form</h2>
    <form action="https://script.google.com/macros/s/AKfycbyvlfVSIUt_K2ysIQ_r085KY83dky1QysnrEUOkc0gsYGtbYj-D0pj-G9MRqbRsqgvq/exec" method="POST" onsubmit="submitForm(event, this)" data-sheet="Mentorship" class="p-4 space-y-2 bg-white rounded shadow">
      <input type="text" name="name" placeholder="Full Name" required class="w-full p-2 border rounded"/>
      <input type="text" name="mentor" placeholder="Preferred Mentor" class="w-full p-2 border rounded"/>
      <button type="submit" class="p-2 bg-red-500 text-white rounded">Submit</button>
    </form>
  </div>

  <!-- Popup -->
  <div id="overlay"></div>
  <div id="popup">
    <p id="popup-message"></p>
    <button onclick="closePopup()">OK</button>
  </div>

  <!-- Scripts -->
  <script>
  function submitForm(event, form) {
      event.preventDefault();

      const formData = {};
      const elements = form.querySelectorAll("input, select, textarea");

      if(form.dataset.sheet) {
          formData["sheet"] = form.dataset.sheet;
      }

      elements.forEach(el => {
          if (el.name) formData[el.name] = el.value;
      });

      fetch(form.action, {
          method: "POST",
          body: JSON.stringify(formData)
      })
      .then(res => res.json())
      .then(data => {
          if(data.result === "success") {
              form.reset();
              showPopup(form.dataset.sheet);
          } else {
              alert("Error: " + data.message);
          }
      })
      .catch(err => {
          console.error("Error:", err);
          alert("There was an error submitting your form.");
      });
  }

  function showPopup(sheetName) {
      document.getElementById('popup-message').textContent = sheetName + " submitted successfully!";
      document.getElementById('overlay').style.display = 'block';
      document.getElementById('popup').style.display = 'block';
  }

  function closePopup() {
      document.getElementById('overlay').style.display = 'none';
      document.getElementById('popup').style.display = 'none';
  }

  document.addEventListener('DOMContentLoaded', () => {
      const pages = document.querySelectorAll('.page');
      const navTriggers = document.querySelectorAll('.nav-trigger, .nav-link');
      const navLinks = document.querySelectorAll('.nav-link');
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');

      function showPage(pageId) {
          pages.forEach(page => page.classList.toggle('hidden', page.id !== pageId));
          navLinks.forEach(link => {
              const linkPageId = link.getAttribute('href').substring(1);
              link.classList.toggle('active', linkPageId === pageId);
          });
          mobileMenu.classList.add('hidden');
          window.scrollTo(0, 0);
          if(history.pushState) {
              history.pushState(null, null, `#${pageId}`);
          } else {
              location.hash = pageId;
          }
      }

      navTriggers.forEach(trigger => {
          trigger.addEventListener('click', (e) => {
              e.preventDefault();
              const pageId = trigger.getAttribute('href').substring(1);
              showPage(pageId);
          });
      });

      mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

      const initialPage = window.location.hash ? window.location.hash.substring(1) : 'home';
      if (document.getElementById(initialPage)) {
          showPage(initialPage);
      } else {
          showPage('home');
      }
  });
  </script>

</body>
</html>
